(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return a});var r="3AA68F17-E271-EE57-FF46-EB6E95626600",o="72F4AE0D-0876-A16A-FF0F-A2D7A65AE300",a="https://api.backendless.com"},13:function(t,e,n){"use strict";(function(t){var r=n(26),o=n.n(r),a=n(10),u=function(t){return function(e){return t(e.response)}},i=function(){return window.sessionStorage.getItem("user-token")?window.sessionStorage.getItem("user-token"):""},c={postQl:function(e){return function(n){return e.state.isLoading=!0,new o.a(function(r,o){return t.request({method:"POST",withCredentials:!1,data:(a=n,JSON.parse(JSON.stringify(a))),headers:{Authorization:"Bearer ".concat(e.state.token),"cache-control":"no-cache","x-apikey":"64fecd3f0cbb54d46d7f7260b86b8ad45d31b","content-type":"application/json"}}).then(function(t){return function(e){var n=e.data,r=e.errors;return t.state.isLoading=!1,r?Promise.reject(r):Promise.resolve(n)}}(e)).then(o,u(r));var a})}},postTask:function(e){return function(n){var r=n.dto;return new o.a(function(n,o){return t.request({method:"POST",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(e),data:r,headers:{"user-token":i()},withCredentials:!1}).then(o,u(n))})}},getTask:function(e){return new o.a(function(n,r){return t.request({method:"GET",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(e),headers:{"user-token":i()},withCredentials:!1}).then(r,u(n))})},putTask:function(e){return function(n){var r=n.dto;return new o.a(function(n,o){return t.request({method:"PUT",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(e),data:r,headers:{"user-token":i()},withCredentials:!1}).then(o,u(n))})}},deleteTask:function(e){return function(n){return new o.a(function(r,o){return t.request({method:"DELETE",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(e,"/").concat(n),headers:{"user-token":i()},withCredentials:!1}).then(o,u(r))})}}};e.a=c}).call(this,n(0))},198:function(t,e){},200:function(t,e){},232:function(t,e){},233:function(t,e){},382:function(t,e){},383:function(t,e){},384:function(t,e){},385:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(152),a={emitter:new(n.n(o).a),pages:["login","logout","createEvent",""],user:{objectId:"",name:""},state:{isLoading:!1,profile:"",tabsShowing:!1,modalShowing:!1,route:"",group:{id:"",name:""},event:{id:"",name:""}},showTabs:function(t){return t.state.tabsShowing=!t.state.tabsShowing},showModal:function(t){return t.state.modalShowing=!t.state.modalShowing},errors:null},u=(n(153),function(t){var e=t.user.id&&window.sessionStorage.getItem("user-token")==t.user["user-token"];return console.log("userLogedIn",e,t.user,window.sessionStorage.getItem("user-token")),e}),i=function(t){var e=t.attrs.model,n="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z",o="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z",a=function(t){return r.default.render(t,Object(r.default)("path",{xmlns:"http://www.w3.org/2000/svg",d:e.state.tabsShowing?n:o}))};return{oncreate:function(t){var e=t.dom;return a(e)},onupdate:function(t){var e=t.dom;return a(e)},view:function(t){var e=t.attrs.model;return Object(r.default)("svg.btn.hamburger",{style:{fill:e.state.tabsShowing?"white":"inherit"},onclick:function(){return e.showTabs(e)}})}}};var c=function(t){var e=t.dom;e.style.opacity=0,e.classList.toggle("slideRight"),e.style.opacity=1},s=function(t){return function(e){var n=e.dom;n.style.opacity=0,setTimeout(function(){n.classList.toggle("slideDown"),n.style.opacity=1},200*(t+1))}},l=function(t){return function(e){var n=e.dom;n.style.opacity=0,setTimeout(function(){n.classList.toggle(t),n.style.opacity=1},200)}},d=n(390),f=n(386),m=n(387),b=n(388),g=n(389),p=Object(d.a)(Object(f.a)("-"),Object(m.a)(" "),Object(b.a)(),Object(g.a)()),v={view:function(t){var e=t.attrs,n=e.action,o=e.label;return[Object(r.default)("button.Btn",{onclick:function(){return n()}},o)]}},j={view:function(t){var e=t.attrs,n=e.action,o=e.label;return[Object(r.default)("button.btn-close",{onclick:function(){return n()}},o)]}},O={groups:function(t){return[Object(r.default)(v,{action:function(){return t.emitter.emit("toggle-group")},label:"Add Group"})]},landing:function(){return["LANDING PAGE"]},login:function(){return["Log in"]},register:function(){return["Register"]},home:function(){return["LANDING PAGE"]},events:function(t){return[Object(r.default)(v,{action:r.default.route.set("/".concat(t.user.username,"/groups")),label:"Back to Groups"}),Object(r.default)(v,{action:r.default.route.set("/".concat(t.user.username,"/").concat(p(t.state.group.name),"/new-event")),label:"Add Event"})]},newGroup:function(t){return[Object(r.default)(v,{action:r.default.route.set("/".concat(t.user.username,"/groups")),label:"Back to Groups"})]},newEvent:function(t){return[Object(r.default)(v,{action:r.default.route.set("/".concat(t.user.username,"/groups").concat(p(t.state.group.name))),label:"Back to Group"})]}},w={view:function(t){var e=t.attrs.model;return Object(r.default)(".actions",O[e.state.route](e))}},h={oncreate:l("slideDown"),view:function(t){var e=t.attrs.model;return Object(r.default)("header.header",{id:"header"},[Object(r.default)(i,{model:e}),Object(r.default)(w,{model:e})])}},k={oncreate:l("slideUp"),view:function(){return Object(r.default)("footer.footer",{oncreate:s,id:"footer"},"by Boaz Blake")}},y=function(t){var e=t.attrs.key;return{oncreate:c,view:function(t){var n=t.attrs.tab;return Object(r.default)("a.tab",{key:e,id:"".concat(n),href:"".concat(n),oncreate:r.default.route.link},n)}}},S=function(t){var e=t.attrs.model.pages;return{oncreate:c,view:function(t){var n=t.attrs.model;return Object(r.default)("aside.sidebar slide-left",{id:"sidebar"},e.map(function(t,e){return Object(r.default)(y,{key:e,active:n.state.route==t,tab:t})}))}}},L={oncreate:c,onbeforeremove:function(t){var e=t.dom;return new Promise(function(){return e.classList.remove("slideRight"),setTimeout(function(){e.classList.add("reverseAnimation","slideRight")},200)})},view:function(t){var e=t.children;return Object(r.default)(".navigationMenu",e)}},E={view:function(t){var e=t.attrs.children;return Object(r.default)("section.content",{id:"content"},e)}},T=function(t){var e=t.attrs.model;return{view:function(t){var n=t.children;return Object(r.default)("section.layout",{id:"layout"},n?[Object(r.default)(h,{model:e}),"phone"==e.state.profile?e.state.tabsShowing?Object(r.default)(L,Object(r.default)(S,{model:e})):null:Object(r.default)(S,{model:e}),Object(r.default)(E,{model:e,children:n}),Object(r.default)(k,{model:e})]:[])}}},A=n(13),G={view:function(t){var e=t.attrs,n=e.model,o=e.g,a=o.objectId,u=o.name,i=o.members;return Object(r.default)(".group",[Object(r.default)("button.btn",{onclick:function(){return r.default.route.set("/".concat(n.user.name,"/").concat(p(u),"/events"))}},Object(r.default)("p.title",u)),Object(r.default)("button.btn",{onclick:function(){n.state.group.id=a,n.state.group.name=u,n.emitter.emit("toggle-group")}},Object(r.default)("p.title","Edit")),Object(r.default)("p.groupSize",i.length),Object(r.default)("button.btn-delete",{onclick:function(){var t;(t=a,A.a.deleteTask("data/groups")(t)).fork(function(t){return function(e){console.warn("errors",e,t)}}(n),function(t){return function(e){console.log("success",e),t.emitter.emit("fetch-groups")}}(n))}},Object(r.default)("p.title","X"))])}},I=function(){var t,e,n={view:function(){return e}};return{oncreate:function(o){e=o.children,(t=document.createElement("div")).className="modal",document.body.appendChild(t),r.default.mount(t,n)},onbeforeupdate:function(t){e=t.children},onbeforeremove:function(){return t.classList.add("hide"),new Promise(function(e){t.addEventListener("animationend",e)})},onremove:function(){r.default.mount(t,null),document.body.removeChild(t)},view:function(){}}},D=n(154),P=function(t){return{dto:t}},C=function(t){return function(e){var n=e.message;t.error=n,console.error("error",t.error)}},z=function(t){return function(e){return function(n){return t.error=null,console.log("saved",e,n),e.emitter.emit("toggle-group",e.emitter.emit("fetch-groups"))}}},M=function(t){return function(e){return console.log("save form",t.state,t.user,e),"groups"==t.state.route?t.state.group.id?(r=t.state.group.id,o=e.data.name,A.a.putTask("data/Groups/".concat(r))(P({name:o}))).fork(C(e),z(e)(t)):function(t){return A.a.postTask("data/Groups")(P({name:t}))}(e.data.name).chain((n=t.user.objectId,function(t){var e=t.objectId;return A.a.putTask("data/Groups/".concat(e,"/members"))(P([n]))})).fork(C(e),z(e)(t)):("events"==t.state.route&&console.log("state in events",e),t.state.route,t.state.route,e);var n,r,o}},B={group:function(t){return[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","Create Group"),Object(r.default)(".fields",[Object(r.default)("label",{for:"name"},"name"),Object(r.default)("input",{type:"text",id:"name",name:"name",value:t.data.name,onchange:function(e){t.data.name=e.target.value}})]),t.errors?Object(r.default)("p.error",t.errors[0]):""])]},event:function(t){return[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","Create Event"),Object(r.default)(".fields",[Object(r.default)("label",{for:"title"},"title"),Object(r.default)("input",{type:"text",id:"title",name:"title",onchange:function(e){t.data.title=e.target.value}})]),Object(r.default)(".fields",[Object(r.default)("label",{for:"description"},"description"),Object(r.default)("input",{type:"textarea",id:"description",name:"description",onchange:function(e){t.data.description=e.target.value}})]),Object(r.default)(".fields",[Object(r.default)("label",{for:"location"},"location"),Object(r.default)("input",{type:"textarea",id:"location",name:"location",onchange:function(e){t.data.location=e.target.value}})]),Object(r.default)(".fields",[Object(r.default)("label",{for:"date"},"date"),Object(r.default)("input",{type:"date",id:"date",name:"date",onchange:function(e){t.data.date=Object(D.format)(e.target.value,"GG")}})]),t.errors?Object(r.default)("p.error",t.errors[0]):""])]}},F={oninit:function(t){var e=t.attrs,n=e.model,r=e.page,o=t.state;return o.form=B[r],o.data={},console.log("page",r,o),o.userId=n.user.id,n.state.group.id?(console.log("id",n.state.group.id),o.data.name=n.state.group.name):console.log("no id"),o},view:function(t){var e=t.attrs.model,n=t.state;return Object(r.default)("form.form",{onsubmit:function(t){e.error=null,t.preventDefault(),n.data&&M(e)(n)}},n.form(n),n.error?Object(r.default)("p.error",n.error):"",Object(r.default)("button[type=submit]",{class:e.state.isLoading?"submitting":"submit"},e.state.isLoading?"Submitting":"Submit"))}},N=Object(d.a)(function(t){return A.a.getTask("data/Groups?".concat(t,"&loadRelations=members"))},function(t){return encodeURI("where=members.objectId = '".concat(t,"'"))}),x=function(t){t.showModal=!t.showModal},q={showModal:!1,oninit:function(t){var e=t.dom,n=t.state,r=t.attrs.model;r.emitter.on("toggle-group",function(){return x(n)},e),r.emitter.on("fetch-groups",function(){return N(r.user.objectId).fork(function(t){return function(e){return t.errors=e}}(n),function(t){return function(e){t.groups=e}}(n))},e)},oncreate:function(t){return t.attrs.model.emitter.emit("fetch-groups")},view:function(t){var e=t.attrs.model,n=t.state;return[Object(r.default)(".groups",n.groups?n.groups.map(function(t,n){return Object(r.default)(G,{model:e,g:t,key:n},"id: ".concat(n))}):"add a group"),n.showModal?Object(r.default)(I,Object(r.default)(".modal-content",[Object(r.default)(F,{model:e,page:"group",id:e.state.group.id}),Object(r.default)(j,{action:function(){e.state.group.id="",e.emitter.emit("toggle-group")},label:"Close"})])):""]},onremove:function(t){var e=t.dom;return t.attrs.model.emitter.removeListener("toggle-group",x,e)}},R=["Yes","No","Maybe"],W={oninit:function(t){var e=t.attrs,n=e.key,r=e.model,o=t.state;console.log(n,r,o)},view:function(t){var e=t.attrs,n=(e.key,e.model,t.state);return n.invite?Object(r.default)(".invite",[Object(r.default)("p.title",n.invite.title),Object(r.default)("p.email",n.invite.email),Object(r.default)("p.date",n.invite.date),Object(r.default)(".rsvps",R.map(function(t){return Object(r.default)("button.button".concat(n.invite.response==t?".isSelected":""),{onclick:function(){n.invite.response=t}},t)})),Object(r.default)("p.partySize",n.invite.partySize)]):""}},J={oninit:function(t){var e=t.attrs.model,n=t.state;n.invites=[],n.errors={},console.log(e)},view:function(t){var e=t.attrs.model,n=t.state;return console.log("state",n),Object(r.default)(".attendaces",n.invites.map(function(t){var n=t.id;return Object(r.default)(W,{model:e,key:n},"id: ".concat(n))}))}},H=function(t){var e=t.email,n=t.password;return!!e&&!!n},U=function(t){var e={login:t.email,password:t.password};return A.a.postTask("users/login")({dto:e})},V=function(t){return function(e){return function(n){window.sessionStorage.setItem("user-token",n["user-token"]),e.user=n,t.errors=null,function(t){return function(e){return r.default.route(document.body,e,rt(t))}}(e)("/".concat(p(e.user.name),"/groups"))}}},Q=function(t){return function(e){var n=e.message;return t.errors=n,console.log(t),t}},X=function(t){return function(e){return function(t){return A.a.postTask("users/register")({dto:t})}(e).chain(function(){return U(e)}).fork(Q(e),V(e)(t))}},Y={view:function(t){var e=t.attrs.model,n=t.state;return Object(r.default)("form.form",{onsubmit:function(t){n.errors=null,t.preventDefault(),H(n)&&function(t){return function(e){return U(e).fork(Q(e),V(e)(t))}}(e)(n)}},[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","Login"),Object(r.default)(".fields",[Object(r.default)("label",{for:"email"},"email"),Object(r.default)("input",{type:"email",id:"email",name:"login",onchange:function(t){return n.email=t.target.value}}),Object(r.default)("label",{for:"password"},"Password"),Object(r.default)("input",{type:"password",id:"password",name:"login",onchange:function(t){return n.password=t.target.value}})]),Object(r.default)("button[type=submit]",{class:e.state.isLoading?"submitting":"submit"},e.state.isLoading?"Submitting":"Submit"),n.errors?Object(r.default)("p.error",n.errors):""]),Object(r.default)("a",{oncreate:r.default.route.link,href:"/register"},"register")])}},K={view:function(t){var e=t.attrs.model,n=t.state;return Object(r.default)("form.form",{onsubmit:function(t){n.errors=null,t.preventDefault(),H(n)&&X(e)(n)}},[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","register"),Object(r.default)(".fields",[Object(r.default)("label",{for:"email"},"email"),Object(r.default)("input",{type:"email",id:"email",name:"register",onchange:function(t){return n.email=t.target.value}}),Object(r.default)("label",{for:"name"},"name"),Object(r.default)("input",{type:"text",id:"name",name:"register",onchange:function(t){return n.name=t.target.value}}),Object(r.default)("label",{for:"password"},"Password"),Object(r.default)("input",{type:"password",id:"password",name:"register",onchange:function(t){return n.password=t.target.value}})]),Object(r.default)("button[type=submit]",{class:e.state.isLoading?"submitting":"submit"},e.state.isLoading?"Submitting":"Submit"),n.errors?Object(r.default)("p.error",n.errors):""]),Object(r.default)("a",{oncreate:r.default.route.link,href:"/login"},"login")])}},Z={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)(Y,{model:e}))}},$={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)(K,{model:e}))}},_=function(t){return{"/login":{onmatch:function(){t.state.route="login"},render:function(){return Object(r.default)(T,{model:t},Object(r.default)(Z,{model:t}))}},"/register":{onmatch:function(){t.state.route="register"},render:function(){return Object(r.default)(T,{model:t},Object(r.default)($,{model:t}))}}}},tt={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)(q,{model:e}))}},et={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)(J,{model:e}))}},nt={view:function(t){var e=t.attrs,n=e.model,o=e.page,a=e.id;return Object(r.default)(".component",Object(r.default)(F,{model:n,page:o,id:a}))}},rt=function(t){return{"/:username/groups":{onmatch:function(){t.state.route="groups",u(t)},render:function(){return Object(r.default)(T,{model:t},Object(r.default)(tt,{model:t}))}},"/:username/:group/events":{onmatch:function(e,n){console.log("args, path",e,n),t.state.route="events",u(t)},render:function(){return Object(r.default)(T,{model:t},Object(r.default)(et,{model:t}))}},"/:username/:group/new-event":{onmatch:function(e,n){console.log("args, path",e,n),t.state.route="newEvent",u(t)},render:function(){return Object(r.default)(T,{model:t},Object(r.default)(nt,{model:t,page:"event",id:null}))}},"/:username/:group/edit/:event":{onmatch:function(e,n){console.log("args, path",e,n),t.state.route="editEvent",u(t)},render:function(){return Object(r.default)(T,{model:t},Object(r.default)(nt,{model:t,page:"event",id:"eventID"}))}},"/logout":{onmatch:function(){t.user={},u(t)},render:function(){return r.default.route(document.body,"/login",_(t))}}}},ot=(n(382),n(383),n(384),document.body);function at(t){return t<668?"phone":t<920?"tablet":"desktop"}var ut=window.innerWidth;a.state.profile=at(ut),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./service-worker.js").then(function(t){console.log("🧟 SW registered: ",t)}).catch(function(t){console.log("⚙️ SW registration failed: ",t)})}),function t(){var e=window.innerWidth;if(ut!==e){ut=e;var n=a.state.profile;a.state.profile=at(e),n!=a.state.profile&&r.default.redraw()}requestAnimationFrame(t)}(),u(a)?r.default.route(document.body,"/".concat(p(a.user.name),"/groups"),rt(a)):r.default.route(ot,"/login",_(a))}},[[385,1,2]]]);
//# sourceMappingURL=main-932e9e80a2a3a0fa28cb-chunk.js.map