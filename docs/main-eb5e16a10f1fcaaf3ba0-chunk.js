(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return a});var r="3AA68F17-E271-EE57-FF46-EB6E95626600",o="72F4AE0D-0876-A16A-FF0F-A2D7A65AE300",a="https://api.backendless.com"},12:function(t,e,n){"use strict";(function(t){var r=n(26),o=n.n(r),a=n(10),u=function(t){return function(e){return function(n){return t.state.isLoading(!1),e(n.response)}}},i=function(t){return function(e){return function(n){return t.state.isLoading(!1),e(n)}}},c=function(){return window.sessionStorage.getItem("user-token")?window.sessionStorage.getItem("user-token"):""},s={postQl:function(e){return function(n){return e.state.isLoading(!0),new o.a(function(r,o){return t.request({method:"POST",withCredentials:!1,data:(a=n,JSON.parse(JSON.stringify(a))),headers:{Authorization:"Bearer ".concat(e.state.token),"cache-control":"no-cache","x-apikey":"64fecd3f0cbb54d46d7f7260b86b8ad45d31b","content-type":"application/json"}}).then(function(t){return function(e){var n=e.data,r=e.errors;return t.state.isLoading(!1),r?Promise.reject(r):Promise.resolve(n)}}(e)).then(i(e)(o),u(e)(r));var a})}},postTask:function(e){return function(n){return function(r){var s=r.dto;return e.state.isLoading(!0),new o.a(function(r,o){return t.request({method:"POST",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(n),data:s,headers:{"user-token":c()},withCredentials:!1}).then(i(e)(o),u(e)(r))})}}},getTask:function(e){return function(n){return e.state.isLoading(!0),new o.a(function(r,o){return t.request({method:"GET",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(n),headers:{"user-token":c()},withCredentials:!1}).then(i(e)(o),u(e)(r))})}},putTask:function(e){return function(n){return function(r){var s=r.dto;return e.state.isLoading(!0),new o.a(function(r,o){return t.request({method:"PUT",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(n),data:s,headers:{"user-token":c()},withCredentials:!1}).then(i(e)(o),u(e)(r))})}}},deleteTask:function(e){return function(n){return function(r){return e.state.isLoading(!0),new o.a(function(o,s){return t.request({method:"DELETE",url:"".concat(a.c,"/").concat(a.b,"/").concat(a.a,"/").concat(n,"/").concat(r),headers:{"user-token":c()},withCredentials:!1}).then(i(e)(s),u(e)(o))})}}}};e.a=s}).call(this,n(0))},254:function(t,e){},256:function(t,e){},288:function(t,e){},289:function(t,e){},335:function(t,e){},336:function(t,e){},337:function(t,e){},338:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(48),a={isLoading:Object(o.a)(!1),profile:"",tabsShowing:!1,modalShowing:!1,route:Object(o.a)(""),group:{id:"",name:""},event:{id:"",name:""}},u={"groups-modal":Object(o.a)(!1)},i={pages:["login","logout","createEvent",""],user:{objectId:"",name:""},state:a,showTabs:function(t){return t.state.tabsShowing=!t.state.tabsShowing},errors:null,getState:function(t){return u[t]()},toggleState:function(t){return u[t](!u[t]())}},c=function(t){var e=t.attrs.model,n="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z",o="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z",a=function(t){return r.default.render(t,Object(r.default)("path",{xmlns:"http://www.w3.org/2000/svg",d:e.state.tabsShowing?n:o}))};return{oncreate:function(t){var e=t.dom;return a(e)},onupdate:function(t){var e=t.dom;return a(e)},view:function(t){var e=t.attrs.model;return Object(r.default)("svg.btn.hamburger",{style:{fill:e.state.tabsShowing?"white":"inherit"},onclick:function(){return e.showTabs(e)}})}}};var s=function(t){var e=t.dom;e.style.opacity=0,e.classList.toggle("slideRight"),e.style.opacity=1},l=function(t){return function(e){var n=e.dom;n.style.opacity=0,setTimeout(function(){n.classList.toggle("slideDown"),n.style.opacity=1},200*(t+1))}},d=function(t){return function(e){var n=e.dom;n.style.opacity=0,setTimeout(function(){n.classList.toggle(t),n.style.opacity=1},200)}},f=n(343),b=n(339),m=n(340),g=n(341),p=n(342),v=Object(f.a)(Object(b.a)("-"),j("???"),Object(m.a)(" "),Object(g.a)(),Object(p.a)()),j=function(t){return function(e){return console.log(t,e),e}},O={view:function(t){var e=t.attrs,n=e.action,o=e.label;return[Object(r.default)("button.Btn",{onclick:function(){return n()}},o)]}},w={view:function(t){var e=t.attrs,n=e.action,o=e.label;return[Object(r.default)("button.btn-close",{onclick:function(){return n()}},o)]}},h={groups:function(t){return[Object(r.default)(O,{action:function(){return t.toggleState("groups-modal")},label:"Add Group"})]},landing:function(){return["LANDING PAGE"]},login:function(){return["Log in"]},register:function(){return["Register"]},home:function(){return["LANDING PAGE"]},events:function(t){return[Object(r.default)(O,{action:function(){return r.default.route.set("/".concat(v(t.user.name),"/groups"))},label:"Back to Groups"}),Object(r.default)(O,{action:function(){return r.default.route.set("/".concat(v(t.user.name),"/").concat(v(t.state.group.name),"/new-event"))},label:"Add Event"})]},newGroup:function(t){return[Object(r.default)(O,{action:function(){return r.default.route.set("/".concat(v(t.user.name),"/groups"))},label:"Back to Groups"})]},newEvent:function(t){return[Object(r.default)(O,{action:function(){return r.default.route.set("/".concat(t.user.username,"/groups").concat(v(t.state.group.name)))},label:"Back to Group"})]}},k={view:function(t){var e=t.attrs.model;return Object(r.default)(".actions",h[e.state.route()](e))}},y={oncreate:d("slideDown"),view:function(t){var e=t.attrs.model;return Object(r.default)("header.header",{id:"header"},[Object(r.default)(c,{model:e}),Object(r.default)(k,{model:e})])}},S={oncreate:d("slideUp"),view:function(){return Object(r.default)("footer.footer",{oncreate:l,id:"footer"},"by Boaz Blake")}},L=function(t){var e=t.attrs.key;return{oncreate:s,view:function(t){var n=t.attrs.tab;return Object(r.default)("a.tab",{key:e,id:"".concat(n),href:"".concat(n),oncreate:r.default.route.link},n)}}},E=function(t){var e=t.attrs.model.pages;return{oncreate:s,view:function(t){var n=t.attrs.model;return Object(r.default)("aside.sidebar slide-left",{id:"sidebar"},e.map(function(t,e){return Object(r.default)(L,{key:e,active:n.state.route()==t,tab:t})}))}}},T={oncreate:s,onbeforeremove:function(t){var e=t.dom;return new Promise(function(){return e.classList.remove("slideRight"),setTimeout(function(){e.classList.add("reverseAnimation","slideRight")},200)})},view:function(t){var e=t.children;return Object(r.default)(".navigationMenu",e)}},A={view:function(t){var e=t.attrs.children;return Object(r.default)("section.content",{id:"content"},e)}},G=function(t){var e=t.attrs.model;return{view:function(t){var n=t.children;return Object(r.default)("section.layout",{id:"layout"},n?[Object(r.default)(y,{model:e}),"phone"==e.state.profile?e.state.tabsShowing?Object(r.default)(T,Object(r.default)(E,{model:e})):null:Object(r.default)(E,{model:e}),Object(r.default)(A,{model:e,children:n}),Object(r.default)(S,{model:e})]:[])}}},I=n(12),D={view:function(t){var e=t.attrs,n=e.reload,o=e.model,a=e.g,u=a.objectId,i=a.name,c=a.members;return Object(r.default)(".group",[Object(r.default)("button.btn",{onclick:function(){return r.default.route.set("/".concat(v(o.user.name),"/").concat(v(i),"/events"))}},Object(r.default)("p.title",i)),Object(r.default)("button.btn",{onclick:function(){o.state.group.id=u,o.state.group.name=i,o.toggleState("groups-modal")}},Object(r.default)("p.title","Edit")),Object(r.default)("p.groupSize",c.length),Object(r.default)("button.btn-delete",{onclick:function(){console.log("reload",n),function(t){return function(e){return I.a.deleteTask(t)("data/groups")(e)}}(o)(u).fork(function(t){return function(e){console.warn("errors",e,t)}}(o),function(t){return function(e){console.log("success",e),t()}}(n))}})])}},P=function(){var t,e,n={view:function(){return e}};return{oncreate:function(o){e=o.children,(t=document.createElement("div")).className="modal",document.body.appendChild(t),r.default.mount(t,n)},onbeforeupdate:function(t){e=t.children},onbeforeremove:function(){return t.classList.add("hide"),new Promise(function(e){t.addEventListener("animationend",e)})},onremove:function(){r.default.mount(t,null),document.body.removeChild(t)},view:function(){}}},C=n(144),z=function(t){return{dto:t}},B=function(t){return function(e){var n=e.message;t.error=n,console.error("error",t.error)}},F=function(t){return function(e){return function(n){return function(r){e.state.group.id="",e.state.group.name="",t.error=null,console.log("saved",e,r),e.toggleState("groups-modal"),n()}}}},N=function(t){return function(e){return function(n){return console.log("save form",t.state,t.user,e),"groups"==t.state.route()?t.state.group.id?function(t){return function(e,n){return I.a.putTask(t)("data/Groups/".concat(e))(z({name:n}))}}(t)(t.state.group.id,e.data.name).fork(B(e),F(e)(t)(n)):function(t){return function(e){return I.a.postTask(t)("data/Groups")(z({name:e}))}}(t)(e.data.name).chain(function(t){return function(e){return function(n){var r=n.objectId;return I.a.putTask(t)("data/Groups/".concat(r,"/members"))(z([e]))}}}(t)(t.user.objectId)).fork(B(e),F(e)(t)(n)):("events"==t.state.route()&&console.log("state in events",e),t.state.route(),t.state.route(),e)}}},x={group:function(t){return[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","Create Group"),Object(r.default)(".fields",[Object(r.default)("label",{for:"name"},"name"),Object(r.default)("input",{type:"text",id:"name",name:"name",value:t.data.name,onchange:function(e){t.data.name=e.target.value}})]),t.errors?Object(r.default)("p.error",t.errors[0]):""])]},event:function(t){return[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","Create Event"),Object(r.default)(".fields",[Object(r.default)("label",{for:"title"},"title"),Object(r.default)("input",{type:"text",id:"title",name:"title",onchange:function(e){t.data.title=e.target.value}})]),Object(r.default)(".fields",[Object(r.default)("label",{for:"description"},"description"),Object(r.default)("input",{type:"textarea",id:"description",name:"description",onchange:function(e){t.data.description=e.target.value}})]),Object(r.default)(".fields",[Object(r.default)("label",{for:"location"},"location"),Object(r.default)("input",{type:"textarea",id:"location",name:"location",onchange:function(e){t.data.location=e.target.value}})]),Object(r.default)(".fields",[Object(r.default)("label",{for:"date"},"date"),Object(r.default)("input",{type:"date",id:"date",name:"date",onchange:function(e){t.data.date=Object(C.format)(e.target.value,"GG")}})]),t.errors?Object(r.default)("p.error",t.errors[0]):""])]}},q={oninit:function(t){var e=t.attrs,n=e.model,r=e.page,o=t.state;return o.form=x[r],o.data={},console.log("page",r,o),o.userId=n.user.id,n.state.group.id?(console.log("id",n.state.group.id),o.data.name=n.state.group.name):(console.log("no id"),o.data={}),o},view:function(t){var e=t.attrs,n=e.model,o=e.reload,a=t.state;return Object(r.default)("form.form",{onsubmit:function(t){n.error=null,t.preventDefault(),a.data&&N(n)(a)(o)}},a.form(a),a.error?Object(r.default)("p.error",a.error):"",Object(r.default)("button[type=submit]",{class:n.state.isLoading()?"submitting":"submit"},n.state.isLoading()?"Submitting":"Submit"))}},R=function(t){return encodeURI("where=members.objectId = '".concat(t,"'"))},W=function(t){return Object(f.a)(function(t){return function(e){return I.a.getTask(t)("data/Groups?".concat(e,"&loadRelations=members"))}}(t),R)},M={oninit:function(t){var e=t.state,n=t.attrs.model;n.state.reload=function(){return W(n)(n.user.objectId).fork(function(t){return function(e){return t.errors=e}}(e),function(t){return function(e){t.groups=e}}(e))}},oncreate:function(t){return t.attrs.model.state.reload()},view:function(t){var e=t.attrs.model,n=t.state;return[Object(r.default)(".groups",n.groups?n.groups.map(function(t,n){return Object(r.default)(D,{reload:e.state.reload,model:e,g:t,key:n},"id: ".concat(n))}):"add a group"),e.getState("groups-modal")?Object(r.default)(P,Object(r.default)(".modal-content",[Object(r.default)(q,{model:e,page:"group",id:e.state.group.id,reload:e.state.reload}),Object(r.default)(w,{action:function(){e.state.group.id="",e.toggleState("groups-modal")},label:"Close"})])):""]}},J=["Yes","No","Maybe"],H={oninit:function(t){var e=t.attrs,n=e.key,r=e.model,o=t.state;console.log(n,r,o)},view:function(t){var e=t.attrs,n=(e.key,e.model,t.state);return n.invite?Object(r.default)(".invite",[Object(r.default)("p.title",n.invite.title),Object(r.default)("p.email",n.invite.email),Object(r.default)("p.date",n.invite.date),Object(r.default)(".rsvps",J.map(function(t){return Object(r.default)("button.button".concat(n.invite.response==t?".isSelected":""),{onclick:function(){n.invite.response=t}},t)})),Object(r.default)("p.partySize",n.invite.partySize)]):""}},U={oninit:function(t){var e=t.attrs.model,n=t.state;n.invites=[],n.errors={},console.log(e)},view:function(t){var e=t.attrs.model,n=t.state;return console.log("state",n),Object(r.default)(".attendaces",n.invites.map(function(t){var n=t.id;return Object(r.default)(H,{model:e,key:n},"id: ".concat(n))}))}},V=function(t){var e=t.email,n=t.password;return!!e&&!!n},Q=function(t){return function(e){var n={login:e.email,password:e.password};return I.a.postTask(t)("users/login")({dto:n})}},Y=function(t){return function(e){return function(n){window.sessionStorage.setItem("user-token",n["user-token"]),e.user=n,t.errors=null,function(t){return function(e){return r.default.route(document.body,e,ut(t))}}(e)("/".concat(v(e.user.name),"/groups"))}}},K=function(t){return function(e){var n=e.message;return t.errors=n,console.log(t),t}},X=function(t){return function(e){return function(t){return function(e){return I.a.postTask(t)("users/register")({dto:e})}}(t)(e).chain(function(){return Q(t)(e)}).fork(K(e),Y(e)(t))}},Z={view:function(t){var e=t.attrs.model,n=t.state;return Object(r.default)("form.form",{onsubmit:function(t){n.errors=null,t.preventDefault(),V(n)&&function(t){return function(e){return Q(t)(e).fork(K(e),Y(e)(t))}}(e)(n)}},[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","Login"),Object(r.default)(".fields",[Object(r.default)("label",{for:"email"},"email"),Object(r.default)("input",{type:"email",id:"email",name:"login",onchange:function(t){return n.email=t.target.value}}),Object(r.default)("label",{for:"password"},"Password"),Object(r.default)("input",{type:"password",id:"password",name:"login",onchange:function(t){return n.password=t.target.value}})]),Object(r.default)("button[type=submit]",{class:e.state.isLoading()?"submitting":"submit"},e.state.isLoading()?"Submitting":"Submit"),n.errors?Object(r.default)("p.error",n.errors):""]),Object(r.default)("a",{oncreate:r.default.route.link,href:"/register"},"register")])}},$={view:function(t){var e=t.attrs.model,n=t.state;return Object(r.default)("form.form",{onsubmit:function(t){n.errors=null,t.preventDefault(),V(n)&&X(e)(n)}},[Object(r.default)("fieldset.fieldset",[Object(r.default)("legend","register"),Object(r.default)(".fields",[Object(r.default)("label",{for:"email"},"email"),Object(r.default)("input",{type:"email",id:"email",name:"register",onchange:function(t){return n.email=t.target.value}}),Object(r.default)("label",{for:"name"},"name"),Object(r.default)("input",{type:"text",id:"name",name:"register",onchange:function(t){return n.name=t.target.value}}),Object(r.default)("label",{for:"password"},"Password"),Object(r.default)("input",{type:"password",id:"password",name:"register",onchange:function(t){return n.password=t.target.value}})]),Object(r.default)("button[type=submit]",{class:e.state.isLoading()?"submitting":"submit"},e.state.isLoading()?"Submitting":"Submit"),n.errors?Object(r.default)("p.error",n.errors):""]),Object(r.default)("a",{oncreate:r.default.route.link,href:"/login"},"login")])}},_={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)(Z,{model:e}))}},tt={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)($,{model:e}))}},et=function(t){return{"/login":{onmatch:function(){t.state.route("login")},render:function(){return Object(r.default)(G,{model:t},Object(r.default)(_,{model:t}))}},"/register":{onmatch:function(){t.state.route("register")},render:function(){return Object(r.default)(G,{model:t},Object(r.default)(tt,{model:t}))}}}},nt=(n(145),function(t){var e=t.user.id&&window.sessionStorage.getItem("user-token")==t.user["user-token"];return console.log("userLogedIn",e,t.user,window.sessionStorage.getItem("user-token")),e}),rt={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)(M,{model:e}))}},ot={view:function(t){var e=t.attrs.model;return Object(r.default)(".component",Object(r.default)(U,{model:e}))}},at={view:function(t){var e=t.attrs,n=e.model,o=e.page,a=e.id;return Object(r.default)(".component",Object(r.default)(q,{model:n,page:o,id:a}))}},ut=function(t){return{"/:username/groups":{onmatch:function(){t.state.route("groups"),nt(t)},render:function(){return Object(r.default)(G,{model:t},Object(r.default)(rt,{model:t}))}},"/:username/:group/events":{onmatch:function(e,n){console.log("args, path",e,n),t.state.route("events"),nt(t)},render:function(){return Object(r.default)(G,{model:t},Object(r.default)(ot,{model:t}))}},"/:username/:group/new-event":{onmatch:function(e,n){console.log("args, path",e,n),t.state.route("newEvent"),nt(t)},render:function(){return Object(r.default)(G,{model:t},Object(r.default)(at,{model:t,page:"event",id:null}))}},"/:username/:group/edit/:event":{onmatch:function(e,n){console.log("args, path",e,n),t.state.route("editEvent"),nt(t)},render:function(){return Object(r.default)(G,{model:t},Object(r.default)(at,{model:t,page:"event",id:"eventID"}))}},"/logout":{onmatch:function(){t.user={},nt(t)},render:function(){return r.default.route(document.body,"/login",et(t))}}}},it=(n(335),n(336),n(337),document.body);function ct(t){return t<668?"phone":t<920?"tablet":"desktop"}var st=window.innerWidth;i.state.profile=ct(st),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./service-worker.js").then(function(t){console.log("🧟 SW registered: ",t)}).catch(function(t){console.log("⚙️ SW registration failed: ",t)})}),function t(){var e=window.innerWidth;if(st!==e){st=e;var n=i.state.profile;i.state.profile=ct(e),n!=i.state.profile&&r.default.redraw()}requestAnimationFrame(t)}(),console.log("MODEL",i),i.user.id?r.default.route(document.body,"/".concat(v(i.user.name),"/groups"),ut(i)):r.default.route(it,"/login",et(i))}},[[338,1,2]]]);
//# sourceMappingURL=main-eb5e16a10f1fcaaf3ba0-chunk.js.map